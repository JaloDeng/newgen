<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.newgen.backmanager.mapper.ActivityPermissionMapper" >

	<!-- Result Map-->
	<resultMap id="BaseResultMap" type="com.newgen.backmanager.bean.ActivityPermission" >
		<result column="id" property="id" />
		<result column="name" property="name" />
		<result column="description" property="description" />
		<result column="url" property="url" />
		<result column="parentId" property="parentId" />
	</resultMap>
	
	<!-- sys_user table all fields -->
	<sql id="Base_Column_List" >
		id, name, description, url, parentId
	</sql>
	
	<select id="findList" parameterType="Object" resultMap="BaseResultMap">
		select <include refid="Base_Column_List" /> 
		from t_activity_permission
		<if test="index != null and row != null">
			limit ${index}, ${row}
		</if>
	</select>
	
	<select id="queryById" parameterType="java.lang.Integer" resultMap="BaseResultMap">
		select <include refid="Base_Column_List" /> 
		from t_activity_permission
		where id = #{value}
	</select>

	<select id="queryByAdminId" parameterType="java.lang.Integer" resultMap="BaseResultMap">
		select ap.*
		from t_admin a 
		left join t_activity_admin_role ar on ar.adminId = a.id
		left join t_activity_role_permission rp on rp.activityRoleId = ar.activityRoleId
		left join t_activity_permission ap on ap.id = rp.activityPermissionId
		where a.id = #{adminId}
	</select>
</mapper>